<!--
  ~ This file is part of Shiro J Bot.
  ~ Copyright (C) 2019-2024  Yago Gimenez (KuuHaKu)
  ~
  ~ Shiro J Bot is free software: you can redistribute it and/or modify
  ~ it under the terms of the GNU General Public License as published by
  ~ the Free Software Foundation, either version 3 of the License, or
  ~ (at your option) any later version.
  ~
  ~ Shiro J Bot is distributed in the hope that it will be useful,
  ~ but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~ MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~ GNU General Public License for more details.
  ~
  ~ You should have received a copy of the GNU General Public License
  ~ along with Shiro J Bot.  If not, see <https://www.gnu.org/licenses/>
  -->

<html>
<head>
    <style>
        :root {
            --radius: 600px;
            --items: 20;
            --current-item:  0;
            --angle: 0deg;
            --distance: -500px;
        }

        body {
            margin: 0;
            overflow: hidden;
            background-color: #070510;
        }

        #container {
            position:  relative;
            perspective: 1000px;
            perspective-origin: top;
            width: 100%;
            height: 100%;

            #carousel {
                position: relative;
                width: 0;
                height: 0;
                margin: auto;
                transform-style: preserve-3d;
                background-color: red;
                transition: transform 1s;

                label {
                    cursor: pointer;
                }

                .item {
                    position: absolute;
                    left: -127px;
                    transform: rotateY(calc(360deg / var(--items) * var(--index))) translateZ(var(--radius)) rotateY(calc(-360deg / var(--items) * var(--index) - var(--angle))) scale(calc(var(--big) / 3));
                    --big: 1 - min(max(var(--current-item) - var(--index), -1 * (var(--current-item) - var(--index))), 1);
                    transition: transform 1s;

                    img {
                        transition: scale 1s;
                        background-image: url("https://i.ibb.co/qFhb2fc/placeholder.webp");
                        background-repeat: no-repeat;
                        background-position: center;
                        width: 255px;
                        height: 380px;
                    }

                    .infobox {
                        position: absolute;
                        opacity: calc(var(--big));
                        transition: opacity 1s;
                        left: 255px;
                        background-color: rgb(220 199 215);
                        border-radius: 10px;
                        border-color: rgb(187 112 161);
                        border-width: 3px;
                        border-style: solid;
                        box-shadow: 0 0 20px 0 black;
                        width: 30vw;
                        height: 50vh;
                        pointer-events: none;
                    }
                }
            }
        }
    </style>
    <script>
        const cards = [
            "WISH", "GOBLET_OF_GIANTS", "PURPLE_POTION",
            "SACRED_HEART", "JUBILEUS", "ZORIN_BLITZ",
            "RAMIEL", "STRELITZIA", "COLA",
            "SHINIGAMI_REALM", "TRANSMUTATION", "SORA",
            "BLACK_GOLD_SAW", "3DMG", "FAR_CRY",
            "CASULL", "JIBRIL", "LUCYNA_KUSHINADA",
            "REG", "JEANNE_DARC",
        ];

        function loadCards() {
            const carousel = document.getElementById("carousel");

            for (let i = 0; i < cards.length; i++){
                const id = cards[i];

                const label = document.createElement("label");
                label.id = `card-${i}`;
                label.for = `item-${i}`;
                label.classList.add("item");
                label.style.setProperty("--index", i.toString());
                label.onclick = () => {
                    const root = document.querySelector(':root').style;
                    const current = root.getPropertyValue("--current-item");

                    root.setProperty("--current-item", i.toString());
                    rotate(current - i);
                }

                const img = document.createElement("img");
                img.src = `https://api.shirojbot.site/v2/shoukan/PT/${id}`;

                label.appendChild(img);
                carousel.appendChild(label);
            }
        }

        let angle = 0;
        function rotate(places) {
            const root = document.querySelector(':root').style;
            const carousel = document.getElementById("carousel");
            const step = 360 / cards.length;
            angle += places * step;

            root.setProperty("--angle", `${angle}deg`);
            carousel.style.transform = `translateZ(var(--distance)) rotateY(${angle}deg)`;
        }
    </script>
</head>
<body onload="loadCards()">
<div id="container">
    <div id="carousel"></div>
    <embed id="infobox">
</div>
</body>
</html>